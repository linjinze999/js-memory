(window.webpackJsonp=window.webpackJsonp||[]).push([[10],{321:function(e,t,o){"use strict";var a=this&&this.__assign||function(){return(a=Object.assign||function(e){for(var t,o=1,a=arguments.length;o<a;o++)for(var n in t=arguments[o])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0}),t.diffShowType=t.filterUserObject=t.nodeFilterOptions=t.nodeFilterType=t.getNodeShowInfoByClass=t.getNodeShowInfo=t.V8SnapshotNodeTypes=t.V8SnapshotEdgeTypes=t.V8SnapshotInfo=void 0;var n,s=o(21),r=o(21);Object.defineProperty(t,"V8SnapshotInfo",{enumerable:!0,get:function(){return r.V8SnapshotInfo}}),Object.defineProperty(t,"V8SnapshotEdgeTypes",{enumerable:!0,get:function(){return r.V8SnapshotEdgeTypes}}),Object.defineProperty(t,"V8SnapshotNodeTypes",{enumerable:!0,get:function(){return r.V8SnapshotNodeTypes}}),t.getNodeShowInfo=function(e){var t=e.edge,o=e.node,n=e.totalSize;return a(a(a({},o),t),{nodeType:o.type,distanceShow:o.distance>=s.V8SnapshotInfo.BASE_SYSTEM_DISTANCE?"-":o.distance,nameShow:o.type===s.V8SnapshotNodeTypes.concatenated_string||o.type===s.V8SnapshotNodeTypes.string?'"'.concat(o.name,'"'):o.type===s.V8SnapshotNodeTypes.regexp?"/".concat(o.name,"/"):o.type===s.V8SnapshotNodeTypes.closure?"".concat(o.name,"()"):o.type===s.V8SnapshotNodeTypes.array?"".concat(o.name||"(internal array)","[]"):o.name,nameShowStyle:{color:o.type===s.V8SnapshotNodeTypes.concatenated_string||o.type===s.V8SnapshotNodeTypes.string||o.type===s.V8SnapshotNodeTypes.regexp?"rgb(200,0,0)":o.type===s.V8SnapshotNodeTypes.closure?void 0:o.type===s.V8SnapshotNodeTypes.bigint?"rgb(35,110,37)":o.type===s.V8SnapshotNodeTypes.number?"rgb(26,26,166)":o.type===s.V8SnapshotNodeTypes.hidden||o.type===s.V8SnapshotNodeTypes.object_shape?"#909399":void 0,fontStyle:o.type===s.V8SnapshotNodeTypes.closure?"italic":void 0},nameShowPrefix:(null==t?void 0:t.type)===s.V8SnapshotEdgeTypes.element?"[".concat(t.name_or_index,"]"):(null==t?void 0:t.name_or_index)||"",nameShowPrefixStyle:{color:[s.V8SnapshotEdgeTypes.internal,s.V8SnapshotEdgeTypes.hidden,s.V8SnapshotEdgeTypes.weak].indexOf(null==t?void 0:t.type)>-1?"#909399":(null==t?void 0:t.type)===s.V8SnapshotEdgeTypes.context?"rgb(26,26,166)":"rgb(136,18,128)"},reachableFromWindow:o.type===s.V8SnapshotNodeTypes.string||o.type===s.V8SnapshotNodeTypes.object&&0===o.name.indexOf("Window")||Boolean(o.flag&s.V8SnapshotInfo.NODE_FLAGS.canBeQueried),detachedDOMTreeNode:Boolean(o.flag&s.V8SnapshotInfo.NODE_FLAGS.detachedDOMTreeNode),selfSizePercent:Math.round(100*o.self_size/n),retainedSizePercent:Math.round(100*o.retained_size/n)})},t.getNodeShowInfoByClass=function(e){var t=e._class,o=e.totalSize;return a(a({},t),{distanceShow:t.distance,nameShow:t.name,nameShowStyle:{},nameShowPrefix:"",nameShowPrefixStyle:{},reachableFromWindow:!1,detachedDOMTreeNode:!1,self_size:t.self,selfSizePercent:Math.round(100*t.self/o),retained_size:t.maxRet,retainedSizePercent:Math.round(100*t.maxRet/o),hasChildren:!!t.idxs.length,rowKey:t.idx})},function(e){e[e.userObject=1]="userObject",e[e.showObject=2]="showObject",e[e.all=3]="all"}(n=t.nodeFilterType||(t.nodeFilterType={})),t.nodeFilterOptions=[{value:n.userObject,label:"用户节点"},{value:n.showObject,label:"可访问节点"},{value:n.all,label:"全部节点"}],t.filterUserObject=function(e){var t=e.node,o=e.edge;return!(t.distance>=s.V8SnapshotInfo.BASE_SYSTEM_DISTANCE)&&(!!(t.flag&s.V8SnapshotInfo.NODE_FLAGS.canBeQueried)&&(![s.V8SnapshotNodeTypes.hidden,s.V8SnapshotNodeTypes.object_shape,s.V8SnapshotNodeTypes.native,s.V8SnapshotNodeTypes.code].includes(t.type)&&(![s.V8SnapshotEdgeTypes.internal,s.V8SnapshotEdgeTypes.hidden,s.V8SnapshotEdgeTypes.weak,s.V8SnapshotEdgeTypes.context].includes(null==o?void 0:o.type)&&(!["__proto__"].includes(null==o?void 0:o.name_or_index)&&((null==o?void 0:o.type)!==s.V8SnapshotEdgeTypes.property||!["BigInt64Array","Int8Array","Int16Array","Int32Array","Uint8Array","Uint16Array","Uint32Array","BigUint64Array","Float32Array","Float64Array","Uint8ClampedArray","Boolean","Map","Symbol","WeakMap","Math","Date","Array","ArrayBuffer","String","RegExp","Set","WeakSet","Object","Number","JSON","Function","BigInt","Promise","Proxy","WebAssembly","FinalizationRegistry","WeakRef","Error","RangeError","URIError","SyntaxError","EvalError","TypeError","ReferenceError","AggregateError","XMLHttpRequest","DataView","isNaN","isFinite","Reflect","Intl","Atomics","setTimeout","setInterval","clearTimeout","clearInterval","encodeURI","decodeURI","encodeURIComponent","decodeURIComponent","eval","parseInt","parseFloat","console","escape","unescape","global","structuredClone","resizeBy","requestIdleCallback","webkitRequestAnimationFrame","requestAnimationFrame","cancelIdleCallback","cancelAnimationFrame","webkitCancelAnimationFrame","webkitResolveLocalFileSystemURL","fetch","alert","confirm","prompt","document","print","open","close","scroll","scrollTo","scrollBy","moveTo","focus","blur","resizeTo","moveBy","find","stop","releaseEvents","postMessage","createImageBitmap","webkitRequestFileSystem","JSCompiler_renameProperty","ShadyCSS","atob","btoa","caches","localStorage","captureEvents","MutationObserver","showOpenFilePicker","showSaveFilePicker","showDirectoryPicker","queueMicrotask","queryLocalFonts","getScreenDetails","getComputedStyle","openDatabase","get launchQueue","get onbeforematch","set onbeforematch","get ondevicemotion","set ondevicemotion","get ondeviceorientation","set ondeviceorientation","get crossOriginIsolated","set crossOriginIsolated","get originAgentCluster","get ondeviceorientationabsolute","set ondeviceorientationabsolute","get onpointerrawupdate","set onpointerrawupdate","get trustedTypes","get caches","get speechSynthesis","get navigation","set navigation","get scheduler","set scheduler","getSelection","get cookieStore","__proto__"].includes(t.name))))))},function(e){e[e.added=0]="added",e[e.removed=1]="removed"}(t.diffShowType||(t.diffShowType={}))},369:function(e,t,o){"use strict";o.r(t);var a=o(35),n=o(321);const{mapGetters:s,mapState:r}=Object(a.a)("V8Snapshot");var i={name:"V8SnapshotComparison",data:()=>({compareSnapshotId:null,nodeFilterSelect:n.nodeFilterType.all,nodeFilterName:"",nodeFilterForm:{nodeFilterSelect:n.nodeFilterType.all},nodeFilterType:n.nodeFilterType,currentNode:null,nodeFilterOptions:n.nodeFilterOptions,rootId:-1}),computed:{rootList(){if(!(this.activeSnapshot&&this.activeSnapshot.snapshot&&this.compareSnapshot&&this.compareSnapshot.snapshot))return[];const e=this.activeSnapshot.snapshot.calculateSnapshotDiff(this.compareSnapshot.snapshot);return Object.keys(e).map(t=>({...e[t],nameShow:t,rowKey:t,hasChildren:!0,level:1}))},totalSize(){return this.activeSnapshot&&this.activeSnapshot.snapshot&&this.activeSnapshot.snapshot.calculateStatistics().total||9999999999},compareTotalSize(){return this.compareSnapshot&&this.compareSnapshot.snapshot&&this.compareSnapshot.snapshot.calculateStatistics().total||9999999999},compareSnapshotList(){return this.snapshotList.filter(e=>e.id!==this.activeId)},compareSnapshot(){return this.compareSnapshotId&&this.snapshotList.find(e=>e.id===this.compareSnapshotId)},currentNodeParents(){return this.currentNode?this.getNodeParents(this.currentNode.nodeId):[]},...r(["snapshotList","activeId"]),...s(["activeSnapshot"])},methods:{load(e,t,o){if(this.activeSnapshot&&this.activeSnapshot.snapshot&&this.compareSnapshot&&this.compareSnapshot.snapshot)if(e.className){const t=2,a=e.addedIds.slice(0,20).map((e,o)=>{const a=this.activeSnapshot.snapshot.snapshot_info.nodes[e],s=this.activeSnapshot.snapshot.getNodeChildren(a.id);return{...Object(n.getNodeShowInfo)({node:a,totalSize:this.totalSize}),nodeId:a.id,removedCount:"",removedSize:"",addedCount:"△",addedSize:a.self_size,countDelta:"",sizeDelta:"",level:t,type:n.diffShowType.added,rowKey:`${n.diffShowType.added}_${t}_${o}_${a.id}`,hasChildren:!!s.length}});e.addedIds.length>20&&a.push({nodeId:"",removedCount:"",removedSize:"",addedCount:"",addedSize:"",countDelta:"",sizeDelta:"",level:t,nameShow:"暂时只显示前20个",nameShowStyle:{color:"#E6A23C"},type:n.diffShowType.added,rowKey:e.rowKey+"_add_tip",hasChildren:!1});const s=e.deletedIds.slice(0,20).map((e,o)=>{const a=this.compareSnapshot.snapshot.snapshot_info.nodes[e],s=this.compareSnapshot.snapshot.getNodeChildren(a.id);return{...Object(n.getNodeShowInfo)({node:a,totalSize:this.compareTotalSize}),nodeId:a.id,removedCount:"△",removedSize:a.self_size,addedCount:"",addedSize:"",countDelta:"",sizeDelta:"",level:t,type:n.diffShowType.removed,rowKey:`${n.diffShowType.removed}_${t}_${o}_${a.id}`,hasChildren:!!s.length}});e.deletedIds.length>20&&s.push({nodeId:"",removedCount:"",removedSize:"",addedCount:"",addedSize:"",countDelta:"",sizeDelta:"",level:t,nameShow:"暂时只显示前20个",nameShowStyle:{color:"#E6A23C"},type:n.diffShowType.removed,rowKey:e.rowKey+"_remove_tip",hasChildren:!1});o([].concat([],a,s))}else{o(this.getNodeChildren(e))}else o([])},onFilter(){this.currentNode=null,this.rootId-=1},filterItem:()=>!0,getNodeChildren(e){let t,o;const a=e.level+1;if(e.type===n.diffShowType.added){if(!this.activeSnapshot||!this.activeSnapshot.snapshot)return[];t=this.activeSnapshot.snapshot,o=this.totalSize}else{if(!this.compareSnapshot||!this.compareSnapshot.snapshot)return[];t=this.compareSnapshot.snapshot,o=this.compareTotalSize}return t.getNodeChildren(e.nodeId).map(s=>{const{node:r,edge:i}=s,d=t.getNodeChildren(r.id).filter(e=>this.filterItem(e));return{...Object(n.getNodeShowInfo)({node:r,edge:i,totalSize:o}),level:a,rowKey:`${a}_${e.type}_${i?i.idx:""}_${r.id}`,hasChildren:!!d.length,nodeId:r.id,removedCount:e.type===n.diffShowType.added?"":"△",removedSize:e.type===n.diffShowType.added?"":r.self_size,addedCount:e.type===n.diffShowType.added?"△":"",addedSize:e.type===n.diffShowType.added?r.self_size:"",countDelta:"",sizeDelta:"",type:e.type}})},loadParents(e,t,o){if(this.currentNode.type===n.diffShowType.added){if(!this.activeSnapshot||!this.activeSnapshot.snapshot)return void o([])}else if(!this.compareSnapshot||!this.compareSnapshot.snapshot)return void o([]);o(this.getNodeParents(e.nodeId))},getNodeParents(e){let t,o;if(this.currentNode.type===n.diffShowType.added){if(!this.activeSnapshot||!this.activeSnapshot.snapshot)return[];t=this.activeSnapshot.snapshot,o=this.totalSize}else{if(!this.compareSnapshot||!this.compareSnapshot.snapshot)return[];t=this.compareSnapshot.snapshot,o=this.compareTotalSize}return t.getNodeParents(e).map(e=>{const{node:a,edge:s}=e,r=t.getNodeParents(a.id);return{...Object(n.getNodeShowInfo)({node:a,edge:s,totalSize:o}),nodeId:a.id,rowKey:`${s?s.idx:""}_${s?s.from_node:a.id}`,hasParents:!!r.length}})},handleCurrentChange(e){!e.className&&e.nodeId&&(this.currentNode=e)}}},d=o(20),l=Object(d.a)(i,(function(){var e=this,t=e._self._c;return t("div",[t("el-card",[t("V8Snapshot-V8SnapshotFiles")],1),e._v(" "),t("br"),e._v(" "),t("el-card",[t("div",{staticStyle:{display:"flex","flex-direction":"row","align-items":"center"},attrs:{slot:"header"},slot:"header"},[e.activeSnapshot?t("div",[e._v(e._s(e.activeSnapshot.name))]):t("div",[e._v("未选择")]),e._v("\n          \n      "),t("el-select",{attrs:{placeholder:"选择对比视图",clearable:"",size:"mini"},model:{value:e.compareSnapshotId,callback:function(t){e.compareSnapshotId=t},expression:"compareSnapshotId"}},e._l(e.compareSnapshotList,(function(e){return t("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1),e._v(" "),t("div",[e.activeSnapshot?e.activeSnapshot.snapshot?t("el-table",{staticStyle:{width:"100%"},attrs:{data:e.rootList,"row-key":"rowKey","max-height":500,size:"small",lazy:"",load:e.load,"tree-props":{children:"children",hasChildren:"hasChildren"},"header-cell-style":{backgroundColor:"#f5f7fa"},"highlight-current-row":""},on:{"current-change":e.handleCurrentChange}},[t("el-table-column",{attrs:{prop:"name",sortable:"",label:"构造函数"},scopedSlots:e._u([{key:"default",fn:function(o){return[o.row.nameShowPrefix?t("span",{style:o.row.nameShowPrefixStyle},[e._v("\n              "+e._s(o.row.nameShowPrefix)+"\n            ")]):e._e(),e._v(" "),o.row.nameShowPrefix?t("span",[e._v(" :: ")]):e._e(),e._v(" "),t("span",{style:o.row.nameShowStyle},[e._v("\n              "+e._s(o.row.nameShow)+"\n            ")]),e._v(" "),o.row.id?t("span",{staticClass:"sub-text"},[e._v(" @"+e._s(o.row.id))]):o.row.count>1?t("span",{staticClass:"sub-text"},[e._v(" x"+e._s(o.row.count))]):e._e(),e._v(" "),o.row.reachableFromWindow?t("span",{attrs:{title:"可通过window访问的用户对象"}},[e._v(" 🀆")]):e._e(),e._v(" "),o.row.detachedDOMTreeNode?t("span",{attrs:{title:"脱离Dom树"}},[e._v(" 🀆")]):e._e()]}}])}),e._v(" "),t("el-table-column",{attrs:{prop:"addedCount",sortable:"",label:"新增数量",align:"right",width:"150px"},scopedSlots:e._u([{key:"default",fn:function(o){return[t("span",[e._v(e._s(o.row.addedCount))])]}}])}),e._v(" "),t("el-table-column",{attrs:{prop:"removedCount",sortable:"",label:"删除数量",align:"right",width:"150px"},scopedSlots:e._u([{key:"default",fn:function(o){return[t("span",[e._v(e._s(o.row.removedCount))])]}}])}),e._v(" "),t("el-table-column",{attrs:{prop:"countDelta",sortable:"",label:"增量",align:"right",width:"150px"},scopedSlots:e._u([{key:"default",fn:function(o){return[o.row.countDelta>0?t("span",[e._v("+")]):e._e(),e._v(" "),t("span",[e._v(e._s(o.row.countDelta))])]}}])}),e._v(" "),t("el-table-column",{attrs:{prop:"addedSize",sortable:"",label:"新增大小",align:"right",width:"150px"},scopedSlots:e._u([{key:"default",fn:function(o){return[t("span",[e._v(e._s(o.row.addedSize))])]}}])}),e._v(" "),t("el-table-column",{attrs:{prop:"removedSize",sortable:"",label:"删除大小",align:"right",width:"150px"},scopedSlots:e._u([{key:"default",fn:function(o){return[t("span",[e._v(e._s(o.row.removedSize))])]}}])}),e._v(" "),t("el-table-column",{attrs:{prop:"sizeDelta",sortable:"",label:"大小增量",align:"right",width:"150px"},scopedSlots:e._u([{key:"default",fn:function(o){return[o.row.sizeDelta>0?t("span",[e._v("+")]):e._e(),e._v(" "),t("span",[e._v(e._s(o.row.sizeDelta))])]}}])})],1):t("div",{directives:[{name:"loading",rawName:"v-loading",value:!0,expression:"true"}]},[e._v("解析中...")]):t("div",[e._v("未选择")]),e._v(" "),t("br"),e._v(" "),t("el-tabs",{attrs:{type:"border-card"}},[t("el-tab-pane",{attrs:{label:"父节点"}},[e.currentNode?t("el-table",{staticStyle:{width:"100%"},attrs:{data:e.currentNodeParents,"row-key":"rowKey","max-height":500,size:"small",lazy:"",load:e.loadParents,"tree-props":{children:"parents",hasChildren:"hasParents"},"header-cell-style":{backgroundColor:"#f5f7fa"}}},[t("el-table-column",{attrs:{prop:"name",sortable:"",label:"对象"},scopedSlots:e._u([{key:"default",fn:function(o){return[t("span",{style:o.row.nameShowPrefixStyle},[e._v("\n                  "+e._s(o.row.nameShowPrefix)+"\n                ")]),e._v(" "),t("span",[e._v(" :: ")]),e._v(" "),t("span",{style:o.row.nameShowStyle},[e._v("\n                  "+e._s(o.row.nameShow)+"\n                ")]),e._v(" "),t("span",{staticClass:"sub-text"},[e._v(" @"+e._s(o.row.id))]),e._v(" "),o.row.reachableFromWindow?t("span",{attrs:{title:"可通过window访问的用户对象"}},[e._v(" 🀆")]):e._e(),e._v(" "),o.row.detachedDOMTreeNode?t("span",{attrs:{title:"脱离Dom树"}},[e._v(" 🀆")]):e._e()]}}],null,!1,118976491)}),e._v(" "),t("el-table-column",{attrs:{prop:"distance",sortable:"",label:"最短根距离",align:"right",width:"150px"},scopedSlots:e._u([{key:"default",fn:function(o){return[t("span",[e._v(e._s(o.row.distanceShow))])]}}],null,!1,3793119334)}),e._v(" "),t("el-table-column",{attrs:{prop:"self_size",sortable:"",label:"自身大小",align:"right",width:"150px"},scopedSlots:e._u([{key:"default",fn:function(o){return[t("span",[e._v(e._s(o.row.self_size))]),e._v(" "),t("span",{staticClass:"sub-text"},[e._v("  "+e._s(o.row.selfSizePercent)+"%")])]}}],null,!1,4104622787)}),e._v(" "),t("el-table-column",{attrs:{prop:"retained_size",sortable:"",label:"总大小",align:"right",width:"150px"},scopedSlots:e._u([{key:"default",fn:function(o){return[t("span",[e._v(e._s(o.row.retained_size))]),e._v(" "),t("span",{staticClass:"sub-text"},[e._v("  "+e._s(o.row.retainedSizePercent)+"%")])]}}],null,!1,3982463107)})],1):e._e()],1)],1)],1)])],1)}),[],!1,null,"62f7a7f8",null);t.default=l.exports}}]);